(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3050],{93619:function(e,t,n){"use strict";var r=n(64836);t.Z=void 0;var l=r(n(64938)),i=n(85893),o=(0,l.default)((0,i.jsx)("path",{d:"m12 4-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"}),"ArrowForward");t.Z=o},7078:function(e,t,n){"use strict";var r=n(64836);t.Z=void 0;var l=r(n(64938)),i=n(85893),o=(0,l.default)((0,i.jsx)("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM6 9h12v2H6V9zm8 5H6v-2h8v2zm4-6H6V6h12v2z"}),"Chat");t.Z=o},76638:function(e,t,n){"use strict";var r=n(64836);t.Z=void 0;var l=r(n(64938)),i=n(85893),o=(0,l.default)((0,i.jsx)("path",{d:"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"}),"Home");t.Z=o},50644:function(e,t,n){"use strict";var r=n(64836);t.Z=void 0;var l=r(n(64938)),i=n(85893),o=(0,l.default)((0,i.jsx)("path",{d:"M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"}),"InsertPhoto");t.Z=o},47962:function(e,t,n){"use strict";var r=n(64836);t.Z=void 0;var l=r(n(64938)),i=n(85893),o=(0,l.default)((0,i.jsx)("path",{d:"M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-1 9H9V9h10v2zm-4 4H9v-2h6v2zm4-8H9V5h10v2z"}),"LibraryBooks");t.Z=o},26307:function(e,t,n){"use strict";var r=n(64836);t.Z=void 0;var l=r(n(64938)),i=n(85893),o=(0,l.default)((0,i.jsx)("path",{d:"M2.01 21 23 12 2.01 3 2 10l15 2-15 2z"}),"Send");t.Z=o},83765:function(e,t,n){"use strict";var r=n(64836);t.Z=void 0;var l=r(n(64938)),i=n(85893),o=(0,l.default)((0,i.jsx)("path",{d:"M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zM1 3c0 .55.45 1 1 1h1l3.6 7.59-1.35 2.44C4.52 15.37 5.48 17 7 17h11c.55 0 1-.45 1-1s-.45-1-1-1H7l1.1-2h7.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.37-.66-.11-1.48-.87-1.48H5.21l-.67-1.43c-.16-.35-.52-.57-.9-.57H2c-.55 0-1 .45-1 1zm16 15c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2z"}),"ShoppingCartRounded");t.Z=o},81911:function(e,t,n){"use strict";var r=n(64836);t.Z=void 0;var l=r(n(64938)),i=n(85893),o=(0,l.default)((0,i.jsx)("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM9 11H7V9h2v2zm4 0h-2V9h2v2zm4 0h-2V9h2v2z"}),"Sms");t.Z=o},26145:function(e,t,n){"use strict";var r=n(64836);t.Z=void 0;var l=r(n(64938)),i=n(85893),o=(0,l.default)((0,i.jsx)("path",{d:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM9 11H7V9h2v2zm4 0h-2V9h2v2zm4 0h-2V9h2v2z"}),"SmsRounded");t.Z=o},35969:function(e,t,n){"use strict";n.d(t,{Z:function(){return f}});var r=n(87462),l=n(63366),i=n(67294);n(76607);var o=n(86010),a=n(94780),s=n(81719),d=n(78884),c=n(1588),u=n(34867);function v(e){return(0,u.Z)("MuiBottomNavigation",e)}(0,c.Z)("MuiBottomNavigation",["root"]);var h=n(85893);let p=["children","className","component","onChange","showLabels","value"],m=e=>{let{classes:t}=e;return(0,a.Z)({root:["root"]},v,t)},x=(0,s.ZP)("div",{name:"MuiBottomNavigation",slot:"Root",overridesResolver:(e,t)=>t.root})(({theme:e})=>({display:"flex",justifyContent:"center",height:56,backgroundColor:(e.vars||e).palette.background.paper})),g=i.forwardRef(function(e,t){let n=(0,d.Z)({props:e,name:"MuiBottomNavigation"}),{children:a,className:s,component:c="div",onChange:u,showLabels:v=!1,value:g}=n,f=(0,l.Z)(n,p),j=(0,r.Z)({},n,{component:c,showLabels:v}),Z=m(j);return(0,h.jsx)(x,(0,r.Z)({as:c,className:(0,o.Z)(Z.root,s),ref:t,ownerState:j},f,{children:i.Children.map(a,(e,t)=>{if(!i.isValidElement(e))return null;let n=void 0===e.props.value?t:e.props.value;return i.cloneElement(e,{selected:n===g,showLabel:void 0!==e.props.showLabel?e.props.showLabel:v,value:n,onChange:u})})}))});var f=g},31449:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/chatting",function(){return n(90746)}])},90746:function(e,t,n){"use strict";n.r(t),n.d(t,{__N_SSP:function(){return eP},default:function(){return eO}});var r=n(85893),l=n(67294),i=n(40793),o=n(74121),a=n(57542),s=n(46941),d=n(22120),c=n(11163),u=n(45269),v=n(61225),h=n(82711),p=n(57412),m=n(9144),x=n(30120),g=n(85214),f=n(81719),j=n(60082),Z=n(44731),_=n(29630),y=n(88767),b=n(9473),w=n(62097),S=n(51126),C=n(81261),k=n(59497);let z=(0,f.ZP)(j.Z)(e=>{let{theme:t}=e;return{"& .MuiBadge-badge":{backgroundColor:"#44b700",color:"#44b700",boxShadow:"0 0 0 2px ".concat(t.palette.background.paper),"&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",animation:"ripple 1.2s infinite ease-in-out",border:"1px solid currentColor",content:'""'}},"@keyframes ripple":{"0%":{transform:"scale(.8)",opacity:1},"100%":{transform:"scale(2.4)",opacity:0}}}}),I=e=>{var t,n,i,o,a;let{name:s,messageTime:d,receiver:c,userList:v,unRead:h,currentId:p,selectedId:x}=e,g=(0,w.Z)(),{configData:f}=(0,b.v9)(e=>e.configData),{profileInfo:j}=(0,b.v9)(e=>e.profileInfo),{data:y,refetch:I,isLoading:L}=(0,k.Z)();(0,l.useEffect)(()=>{I()},[]);let R=null==v?void 0:null===(t=v.receiver)||void 0===t?void 0:t.image,D=(null==y?void 0:null===(n=y.userinfo)||void 0===n?void 0:n.id)===v.last_message.sender_id,E=localStorage.getItem("direction");return(0,r.jsxs)(u.Xw,{direction:"row",spacing:2,alignItems:"center",padding:"10px 15px 10px 10px",sx:{background:x===p?e=>e.palette.primary.main:""},children:[(0,r.jsx)(z,{overlap:"circular",anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,r.jsx)(Z.Z,{src:"".concat("vendor"===v.receiver_type?null==f?void 0:null===(o=f.base_urls)||void 0===o?void 0:o.store_image_url:"delivery_man"===v.receiver_type?null==f?void 0:null===(a=f.base_urls)||void 0===a?void 0:a.delivery_man_image_url:void(null==f||null===(i=f.base_urls)||void 0===i||i.business_logo_url),"/").concat(R)})}),(0,r.jsxs)(u.Xw,{children:[(0,r.jsxs)(m.Z,{direction:"row",justifyContent:"space-between",marginRight:"rtl"===E?"1rem":"0rem",color:x===p?g.palette.neutral[100]:g.palette.neutral[1e3],children:[(0,r.jsx)(_.Z,{children:c}),(0,r.jsx)(_.Z,{variant:"h5",fontWeight:"700",children:!L&&!D&&h>0&&h})]}),(0,r.jsxs)(m.Z,{direction:"row",justifyContent:"space-between",color:x===p?g.palette.neutral[100]:g.palette.neutral[1e3],children:[(0,r.jsx)(_.Z,{variant:"h7",children:(0,S.t)(s)}),(0,r.jsx)(_.Z,{variant:"h7",children:(0,C.gM)(d)})]})]})]})};var L=n(40077);n(73782);var R=n(77591);let D=e=>{let{channelList:t,handleChannelOnClick:n,channelLoading:l,selectedId:i}=e,{configData:o}=(0,b.v9)(e=>e.configData);if(l)return(0,r.jsx)(r.Fragment,{children:[1,2,3,4].map(e=>(0,r.jsx)(x.Z,{padding:".5rem",children:(0,r.jsxs)(m.Z,{direction:"row",spacing:3,children:[(0,r.jsx)(p.Z,{animation:"wave",variant:"circular",width:40,height:40}),(0,r.jsxs)(m.Z,{justifyContent:"space-between",direction:"column",width:"100%",children:[(0,r.jsx)(p.Z,{animation:"wave",height:15,width:"20%"}),(0,r.jsx)(p.Z,{animation:"wave",height:15,width:"40%"})]})]})},e))});let a=e=>{var t,n;return"customer"===e.sender_type?(0,r.jsx)(I,{name:e.receiver_type.replaceAll("_"," "),messageTime:e.created_at,receiver:e.receiver?e.receiver.f_name:null==o?void 0:o.business_name,unRead:e.unread_message_count,userList:e,selectedId:i,currentId:e.id}):(0,r.jsx)(I,{name:e.sender_type.replaceAll("_"," "),messageTime:e.created_at,receiver:(null==e?void 0:null===(t=e.sender)||void 0===t?void 0:t.f_name.concat(" ",null==e?void 0:null===(n=e.sender)||void 0===n?void 0:n.l_name))||" ",unRead:e.unread_message_count,userList:e,selectedId:i,currentId:e.id})};return(0,r.jsxs)(u.Xw,{children:[(null==t?void 0:t.length)>0&&(0,r.jsx)(L.Z,{style:{maxHeight:"60vh"},children:(0,r.jsx)(g.Z,{disablePadding:!0,children:null==t?void 0:t.map((e,t)=>(0,r.jsx)(u.DF,{disableGutters:!0,disablePadding:!0,cursor:"true",onClick:()=>n(e),children:a(e)},t))})}),0===t.length&&(0,r.jsx)(m.Z,{width:"100%",justifyContent:"center",alignItems:"center",children:(0,r.jsx)(R.ZT,{children:(0,S.t)("You have no channels.")})})]})};var E=n(9041),M=n(80562),H=n(42761),T=n(63270),V=n(31812),P=n(50594);let O=e=>{let{searchValue:t,setSearchValue:n,handleSearch:l,isLoading:i,handleReset:o,searchSubmitHandler:a}=e,s=e=>{e.preventDefault(),l(e.target.value)};return(0,r.jsx)(m.Z,{padding:".4rem",children:(0,r.jsx)("form",{onSubmit:e=>a(e),children:(0,r.jsxs)(T.ol,{children:[(0,r.jsx)(T.el,{fullWidth:!0,label:(0,S.t)("Search"),placeholder:(0,S.t)("Search"),InputProps:{startAdornment:(0,r.jsx)(E.Z,{position:"start",children:(0,r.jsx)(H.Z,{fontSize:"small"})})},value:t,onChange:e=>s(e)}),""!==t&&(0,r.jsx)(r.Fragment,{children:i?(0,r.jsx)(u.B7,{right:-1,children:(0,r.jsx)(V.Z,{loading:!0,variant:"text",sx:{width:"10px"}})}):(0,r.jsx)(u.B7,{onClick:o,children:(0,r.jsx)(M.Z,{children:(0,r.jsx)(P.Z,{fontSize:"small"})})})})]})})})};O.propTypes={};var B=n(7078);let F=e=>{let{handleChannelOnClick:t}=e,n=(0,w.Z)(),{t:l}=(0,d.$G)();return(0,r.jsxs)(m.Z,{direction:"row",justifyContent:"flex-start",alignItems:"center",backgroundColor:n.palette.primary.main,spacing:2,padding:"1rem",sx:{cursor:"pointer",borderRadius:"4px"},onClick:()=>t({receiver_type:"admin",sender_type:"customer"}),children:[(0,r.jsx)(B.Z,{sx:{color:e=>e.palette.whiteContainer.main}}),(0,r.jsx)(_.Z,{sx:{color:e=>e.palette.whiteContainer.main},children:l("Chatting with admin")})]})},N=e=>{let{isFetched:t,handleToggleSidebar:n,selectedId:l,handleReset:i,searchSubmitHandler:o,channelLoading:a,isLoading:s,channelList:d,handleChannelOnClick:c,searchValue:u,setSearchValue:v,handleSearch:h}=e,x=d&&(null==d?void 0:d.find(e=>"admin"===e.receiver_type));return(0,r.jsxs)(m.Z,{spacing:2,padding:".5rem",marginTop:{xs:"20px",md:"0px"},children:[t?0!==d.length&&x?void 0:(0,r.jsx)(F,{handleChannelOnClick:c}):(0,r.jsx)(p.Z,{variant:"rantangle",width:"100%",height:"50px"}),(0,r.jsx)(O,{searchValue:u,setSearchValue:v,handleSearch:h,isLoading:s,handleReset:i,searchSubmitHandler:o}),(0,r.jsx)(D,{channelList:d,handleChannelOnClick:c,channelLoading:a,selectedId:l})]})},A=e=>{let{chatFrom:t,open:n,isLoading:l,selectedId:i,handleReset:o,handleToggleSidebar:a,channelLoading:s,isFetched:d,channelList:c,handleChannelOnClick:u,searchSubmitHandler:p,setSearchValue:m,searchValue:x,handleSearch:g}=e,f=(0,v.Z)(e=>e.breakpoints.up("md"));return f?(0,r.jsx)(h.zr,{variant:"persistent",anchor:"left",open:Boolean("true"),children:(0,r.jsx)(N,{isFetched:d,handleToggleSidebar:a,channelList:c,handleChannelOnClick:u,setSearchValue:m,searchValue:x,handleSearch:g,isLoading:l,handleReset:o,searchSubmitHandler:p,channelLoading:s,selectedId:i})}):(0,r.jsxs)(h.lt,{anchor:"left",variant:"temporary",open:"true"===t?!n:n,children:[" ",(0,r.jsx)(N,{isFetched:d,handleToggleSidebar:a,channelList:c,handleChannelOnClick:u,setSearchValue:m,searchValue:x,handleSearch:g,isLoading:l,handleReset:o,searchSubmitHandler:p,selectedId:i})]})};n(30381);var X=n(65213),G=n(27036),U=n(58861),W=n(18377);let q=e=>{var t,n,l,i,o,a,s,d,c,u,v,h,p,x,g,f,j,Z,y,S,k,z,I,L,R,D,E,M,H,T,V,P,O;let B,F,N;let A=(0,w.Z)(),{body:q,createdAt:$,messgageData:K,authorAvatar:Q,conversationData:J,image:Y,handleImageOnClick:ee}=e,{configData:et}=(0,b.v9)(e=>e.configData),en=localStorage.getItem("direction"),er=null==et?void 0:null===(t=et.base_urls)||void 0===t?void 0:t.customer_image_url,el=K.sender_id,ei=null==et?void 0:null===(n=et.base_urls)||void 0===n?void 0:n.chat_image_url;return(null==J?void 0:null===(l=J.conversation)||void 0===l?void 0:l.sender_type)==="customer"?(B=null==J?void 0:J.conversation.sender_id,F=null==J?void 0:null===(i=J.conversation)||void 0===i?void 0:null===(o=i.receiver)||void 0===o?void 0:o.image,N=null==J?void 0:null===(a=J.conversation)||void 0===a?void 0:null===(s=a.sender)||void 0===s?void 0:s.image):B=null==J?void 0:null===(d=J.conversation)||void 0===d?void 0:null===(c=d.receiver)||void 0===c?void 0:c.id,(0,r.jsxs)(X.yj,{authortype:el,usertype:B,language_direction:en,children:[(0,r.jsx)(X.zU,{src:"".concat(el===B?er:(null==J?void 0:null===(u=J.conversation)||void 0===u?void 0:u.receiver_type)==="vendor"?null==et?void 0:null===(p=et.base_urls)||void 0===p?void 0:p.restaurant_image_url:(null==J?void 0:null===(v=J.conversation)||void 0===v?void 0:v.receiver_type)==="delivery_man"?null==et?void 0:null===(x=et.base_urls)||void 0===x?void 0:x.delivery_man_image_url:void(null==et||null===(h=et.base_urls)||void 0===h||h.business_logo_url),"/").concat(el===B?N:F),authortype:el,usertype:B}),(0,r.jsxs)(X.ef,{children:[(0,r.jsx)(m.Z,{direction:"row",spacing:3,justifyContent:el===B?"flex-end":"flex-start",children:null==Y?void 0:Y.map((e,t)=>(0,r.jsx)(W.Z,{sx:{cursor:"pointer"},onClick:()=>ee("".concat(ei,"/").concat(e)),children:(0,r.jsx)(U.Z,{src:"".concat(ei,"/").concat(e),width:"100px",height:"90px",objectFit:"contained"})},t))}),q&&(0,r.jsxs)(X.UK,{authortype:el,usertype:B,children:[(0,r.jsx)(m.Z,{mb:1,children:(0,r.jsx)(_.Z,{pt:"3px",color:el===B?A.palette.footer.appDownloadButtonBg:A.palette.neutral[100],variant:"subtitle2",align:el===B?"right":"left",children:(null==J?void 0:null===(g=J.conversation)||void 0===g?void 0:g.sender_type)==="customer"?el===B?null==J?void 0:null===(f=J.conversation)||void 0===f?void 0:null===(j=f.sender)||void 0===j?void 0:j.f_name.concat(" ",null==J?void 0:null===(Z=J.conversation)||void 0===Z?void 0:null===(y=Z.sender)||void 0===y?void 0:y.l_name):(null==J?void 0:null===(S=J.conversation)||void 0===S?void 0:null===(k=S.receiver)||void 0===k?void 0:k.f_name)?null==J?void 0:null===(z=J.conversation)||void 0===z?void 0:null===(I=z.receiver)||void 0===I?void 0:I.f_name.concat(" ",null==J?void 0:null===(L=J.conversation)||void 0===L?void 0:null===(R=L.receiver)||void 0===R?void 0:R.l_name):null==et?void 0:et.business_name:el===B?(null==J?void 0:null===(D=J.conversation)||void 0===D?void 0:null===(E=D.receiver)||void 0===E?void 0:E.f_name.concat(" ",null==J?void 0:null===(M=J.conversation)||void 0===M?void 0:null===(H=M.receiver)||void 0===H?void 0:H.l_name))||" ":(null==J?void 0:null===(T=J.conversation)||void 0===T?void 0:null===(V=T.sender)||void 0===V?void 0:V.f_name.concat(" ",null==J?void 0:null===(P=J.conversation)||void 0===P?void 0:null===(O=P.sender)||void 0===O?void 0:O.l_name))||" "})}),(0,r.jsx)(_.Z,{color:el===B?A.palette.footer.appDownloadButtonBg:A.palette.neutral[100],align:el===B?"right":"left",children:q||""})]}),(0,r.jsxs)(X.qo,{authortype:el,usertype:B,children:[el===B?(0,r.jsx)(G.Z,{fontSize:"14px",style:{color:0===K.is_seen?A.palette.primary.main:"green"}}):"",(0,r.jsx)(_.Z,{color:"textSecondary",noWrap:!0,variant:"caption",children:(0,C.gM)($)})]})]})]})};q.propTypes={};var $=n(86390),K=n(73369);let Q=e=>{let{conversationData:t,scrollBottom:n}=e,[i,o]=(0,l.useState)([]),[a,s]=(0,l.useState)(!1),[d,c]=(0,l.useState)(),[u,v]=(0,l.useState)(!1),[h,p]=(0,l.useState)(null);(0,l.useRef)(null),(0,l.useEffect)(()=>{let e=[];t.length>0&&(t.forEach(t=>{var n;c(t),null==t||null===(n=t.messages)||void 0===n||n.forEach(t=>e.push(t))}),o(e),s(!0))},[t]),(0,l.useEffect)(()=>{h&&v(!0)},[h]);let m=e=>{p(e)},g=e=>{v(e),p(null)};return(0,r.jsx)(x.Z,{sx:{p:2},children:(0,r.jsxs)(r.Fragment,{children:[null==i?void 0:i.map((e,t)=>(0,r.jsx)(q,{body:null==e?void 0:e.message,messgageData:e&&e,createdAt:null==e?void 0:e.updated_at,conversationData:d,image:JSON.parse(null==e?void 0:e.file),handleImageOnClick:m},t)).reverse(),(0,r.jsx)($.Z,{openModal:u,setModalOpen:g,handleClose:g,children:(0,r.jsx)(K.Z,{modalImage:h,handleModalClose:g})}),n&&(0,r.jsx)(ev,{})]})})};Q.propTypes={};var J=n(67836),Y=n(72389),ee=n(50644),et=n(26307),en=n(86501),er=n(81401);let el=e=>{let{body:t,removeImage:n}=e;(0,w.Z)();let[i,o]=(0,l.useState)();return(0,l.useEffect)(()=>{o(t.file)},[t.file]),(0,r.jsx)(er.Z,{sx:{position:"absolute",bottom:78,padding:"5px",display:"flex",flexDirection:"row",gap:"20px"},children:null==i?void 0:i.map((e,t)=>(0,r.jsxs)(m.Z,{sx:{position:"relative",width:"auto"},direction:"row",children:[(0,r.jsx)(U.Z,{objectFit:"contained",src:URL.createObjectURL(e),height:"70px",width:"100px",borderRadius:".5rem"}),(0,r.jsx)(M.Z,{sx:{position:"absolute",right:-10,bottom:-10},children:(0,r.jsx)(P.Z,{onClick:()=>n(e.name),sx:{color:e=>e.palette.error.main}})})]},t))})};var ei=n(70557),eo=n(46573);let ea=(0,f.ZP)(J.Z)({"& label.Mui-focused":{color:"#EF7822",background:"#fff"},"& .MuiInput-underline:after":{borderBottomColor:"#EF7822",background:"#fff"},"& .MuiOutlinedInput-notchedOutline":{border:"none"},"& .MuiOutlinedInput-root":{border:"2px solid #D1D5DB","& fieldset":{},"&:hover fieldset":{borderColor:"#EF7822"},"&.Mui-focused fieldset":{borderColor:"#EF7822"}}}),es=e=>{let{onSend:t}=e,[n,i]=(0,l.useState)({text:"",file:[]}),o=(0,l.useRef)(null),a=e=>{i({...n,text:e.target.value})},s=()=>{if(!n){en.Am.error((0,S.t)("write something"));return}n.file.length>3?en.Am.error((0,S.t)(ei.$m)):(null==t||t(n),i({text:"",file:[]}))},d=()=>{o.current.click()},c=e=>{"Enter"!==e.code||e.shiftKey||s()},u=e=>{i({...n,file:[...n.file,...e.target.files]})},v=e=>{let t=n.file.filter(t=>t.name!==e);i({file:t})};return(0,r.jsxs)(x.Z,{sx:{alignItems:"center",backgroundColor:e=>e.palette.neutral[200],display:"flex",flexShrink:0,p:3,position:"relative"},children:[(0,r.jsx)(ea,{fullWidth:!0,onChange:a,onKeyUp:c,placeholder:(0,S.t)("Leave a message"),value:n.text,size:"small",multiline:!0}),(0,r.jsxs)(x.Z,{sx:{alignItems:"center",display:"flex",m:-2,ml:"rtl"!==(0,eo.G)()&&2,mr:"rtl"===(0,eo.G)()&&"1rem"},children:[(0,r.jsx)(Y.Z,{title:(0,S.t)("Attach photo"),children:(0,r.jsx)(x.Z,{sx:{m:1},children:(0,r.jsx)(M.Z,{edge:"end",onClick:d,children:(0,r.jsx)(ee.Z,{fontSize:"small"})})})}),(0,r.jsx)(Y.Z,{title:(0,S.t)("Send"),children:(0,r.jsx)(x.Z,{sx:{m:1},children:(0,r.jsx)(M.Z,{color:"primary",disabled:""===n.text&&0===n.file.length,sx:{backgroundColor:"primary.main",color:"primary.contrastText",flexDirection:"row-reverse",transform:"rtl"===(0,eo.G)()&&"rotate(180deg)","&:hover":{backgroundColor:"primary.dark"}},onClick:s,children:(0,r.jsx)(et.Z,{fontSize:"small"})})})})]}),(0,r.jsx)("input",{hidden:!0,ref:o,type:"file",multiple:!0,onChange:u}),n.file.length>0&&(0,r.jsx)(el,{body:n,removeImage:v})]})};var ed=n(17069);let ec=(0,ed.Z)(e=>({root:{"&::-webkit-scrollbar":{width:7},"&::-webkit-scrollbar-track":{boxShadow:"inset 0 0 6px rgba(0, 0, 0, 0.3)"},"&::-webkit-scrollbar-thumb":{backgroundColor:"darkgrey",outline:"1px solid slategrey"}}})),eu=(0,f.ZP)(x.Z)(e=>{let{theme:t}=e;return{display:"flex",flexDirection:"column",flexGrow:1,minHeight:"70vh",height:"100%",justifyContent:"space-between"}}),ev=()=>{let e=(0,l.useRef)();return(0,l.useEffect)(()=>e.current.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"})),(0,r.jsx)("div",{ref:e})},eh=e=>{let{conversationData:t,handleChatMessageSend:n,messageIsLoading:l,handleScroll:i,scrollBottom:o}=e,a=ec();return(0,r.jsxs)(eu,{children:[(0,r.jsx)(x.Z,{sx:{overflowY:"scroll",height:"60vh"},onScroll:i,className:a.root,children:t&&(0,r.jsx)(Q,{conversationData:t,scrollBottom:o})}),(0,r.jsx)(es,{onSend:n})]})};var ep=n(81911);let em=(0,f.ZP)(x.Z)(e=>{let{theme:t}=e;return{alignItems:"center",display:"flex",flexGrow:1,flexDirection:"column",justifyContent:"center",overflow:"hidden",height:"60vh"}}),ex=(0,f.ZP)(Z.Z)(e=>{let{theme:t}=e;return{backgroundColor:t.palette.primary.main,color:t.palette.primary.contrastText,height:56,width:56}}),eg=e=>{let{t}=(0,d.$G)();return(0,r.jsxs)(em,{children:[(0,r.jsx)(ex,{children:(0,r.jsx)(ep.Z,{fontSize:"small"})}),(0,r.jsx)(_.Z,{color:"textSecondary",sx:{mt:2},variant:"subtitle1",children:t("Select And Start meaningful conversations!")})]})};eg.propTypes={};var ef=(0,n(54235).Z)((0,r.jsx)("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"}),"ArrowBack"),ej=n(93619);let eZ=e=>{var t,n,l,i,o;let{receiver:a,mdUp:s,handleToggleSidebar:d,ChatImageUrl:c,userImage:u,theme:v}=e,p=localStorage.getItem("direction");return(0,r.jsx)("div",{children:(0,r.jsxs)(h.hE,{direction:"row",mdup:s,children:[!s&&("rtl"===p?(0,r.jsx)(M.Z,{onClick:d,children:(0,r.jsx)(ej.Z,{fontSize:"small"})}):(0,r.jsx)(M.Z,{onClick:d,children:(0,r.jsx)(ef,{fontSize:"small"})})),(0,r.jsxs)(m.Z,{direction:"row",spacing:1,justifyContent:"center",alignItems:"center",children:[(0,r.jsxs)(m.Z,{justifyContent:"flex-end",alignItems:"center",children:[(0,r.jsx)(_.Z,{align:"right",color:v.palette.neutral[100],children:"customer"===a.sender_type?(null==a?void 0:null===(t=a.receiver)||void 0===t?void 0:t.f_name.concat(" ",null==a?void 0:null===(n=a.receiver)||void 0===n?void 0:n.l_name))||" ":(null==a?void 0:null===(l=a.sender)||void 0===l?void 0:l.f_name.concat(" ",null==a?void 0:null===(i=a.sender)||void 0===i?void 0:i.l_name))||" "}),(0,r.jsx)(_.Z,{variant:"h6",color:v.palette.neutral[100],textTransform:"capitalize",align:"right",children:(null==a?void 0:a.sender_type)==="customer"?null==a?void 0:a.receiver_type.replaceAll("_"," "):null==a?void 0:null===(o=a.sender_type)||void 0===o?void 0:o.replaceAll("_"," ")})]}),(0,r.jsx)(M.Z,{children:(0,r.jsx)(Z.Z,{fontSize:"small",src:"".concat(c(),"/").concat(u),sx:{width:35,height:35}})})]})]})})};eZ.propTypes={};var e_=n(90149);function ey(){return(0,r.jsx)(m.Z,{alignItems:"center",style:{left:"50%"},children:(0,r.jsx)(e_.Z,{})})}let eb=()=>(0,r.jsxs)(u.Xw,{height:"71vh",justifyContent:"space-between",children:[(0,r.jsx)(ey,{}),(0,r.jsx)(es,{})]});var ew=n(61176),eS=n(60274),eC=n(67759);let ek=async()=>{let{data:e}=await ew.Z.get("".concat(eS.It));return e},ez=e=>(0,y.useQuery)("get_channel_list",()=>ek(),{enabled:!1,onSuccess:e,onError:eC.R}),eI=async(e,t)=>{let{channelId:n,apiFor:r,page_limit:l,offset:i}=e,{data:o}=await ew.Z.get("".concat(eS.Fq,"?").concat(r,"=").concat("admin"===n?0:n,"?&offset=").concat(t,"&limit=").concat(l));return o},eL=e=>(0,y.useInfiniteQuery)("get_conversation",t=>{let{pageParam:n=e.offset}=t;return eI(e,n)},{getNextPageParam(e,t){let n=t.length+1;return e.messages.length>0?n:void 0},enabled:!1,onError:eC.R}),eR=async e=>{let{id:t,text:n,receiver_type:r,receiverId:l,file:i}=e,o=new FormData;o.append(l?"receiver_id":"conversation_id","admin"===t?0:t),""===n?i.forEach(e=>{o.append("image[]",e)}):(o.append("message",n),i.forEach(e=>{o.append("image[]",e)})),o.append("receiver_type",r);let{data:a}=await ew.Z.post("".concat(eS.xD),o,{headers:{"Content-Type":"multipart/form-data"}});return a},eD=()=>(0,y.useMutation)("store_message",eR),eE=async e=>{let{data:t}=await ew.Z.get("".concat(eS.Pt,"?name=").concat(e,"&limit=20& offset=1"));return t},eM=(e,t)=>(0,y.useQuery)("get_search_list",()=>eE(e),{enabled:!1,onSuccess:t});var eH=n(55806);let eT=e=>{var t;let{configData:n}=e,i=(0,w.Z)(),[o,a]=(0,l.useState)(10),[s,d]=(0,l.useState)(1),[h,p]=(0,l.useState)(!0),[x,g]=(0,l.useState)(null),[f,j]=(0,l.useState)([]),[Z,_]=(0,l.useState)([]),[y,b]=(0,l.useState)("conversation_id"),[S,C]=(0,l.useState)(),[k,z]=(0,l.useState)(),[I,L]=(0,l.useState)(),[R,D]=(0,l.useState)(""),[E,M]=(0,l.useState)(),[H,T]=(0,l.useState)(),V=(0,v.Z)(e=>e.breakpoints.up("md")),P=(0,v.Z)(e=>e.breakpoints.down("md")),O=(0,c.useRouter)(),{id:B,type:F,routeName:N,conversationId:X,chatFrom:G}=O.query,[U,W]=(0,l.useState)(!0),q=()=>{p(!1)},$=()=>{p(e=>!e)},K=e=>{j(e.conversations)},{refetch:Q,isFetched:J,isLoading:Y}=ez(K),{data:ee,isSuccess:et,hasNextPage:en,fetchNextPage:er,isFetchingNextPage:el,refetch:ei,isRefetching:eo,hasPreviousPage:ea}=eL({channelId:x,apiFor:y,page_limit:o,offset:s});(0,l.useEffect)(()=>{if(F&&C(F),X){g(X),W(!0);let e=0!==f.length&&f.filter(e=>e.id==X);M(e[0])}"admin"===F?L(X):L(null)},[X,f,F]),(0,l.useEffect)(()=>{if(B&&N&&F){let e=0!==f.length&&f.filter(e=>{var t,n;return"vendor"===F?(null==e?void 0:null===(t=e.receiver)||void 0===t?void 0:t.vendor_id)==B:"delivery_man"===F?(null==e?void 0:null===(n=e.sender)||void 0===n?void 0:n.deliveryman_id)==B:void 0});M(e[0]),g(B),L(B),C(F),b(N)}},[B,F,N,G,f]),(0,l.useEffect)(()=>{x&&ei()},[x]),(0,l.useEffect)(()=>{_([ee])},[ee]);let es=async e=>{var t,n;L(null),await Q(),"admin"===e.receiver_type?(b("admin_id"),g("admin"),W(!0),C(e.receiver_type),T(null==e?void 0:null===(t=e.receiver)||void 0===t?void 0:t.image),M(e)):(b("conversation_id"),g(e.id),W(!0),C(e.receiver_type),z(e.receiver.f_name),T(null==e?void 0:null===(n=e.receiver)||void 0===n?void 0:n.image),M(e)),P&&p(e=>!e)};(0,l.useEffect)(()=>{Q().then()},[]);let{mutate:ed,isLoading:ec}=eD(),eu=e=>{let t={receiver_type:S,id:x,receiverId:I,...e},n=async e=>{await ei(),await Q()};ed(t,{onSuccess:n,onError:eC.R})},ev=e=>{e&&j(e.conversations)},{isLoading:ep,isRefetching:em,refetch:ex}=eM(R,ev),ef=e=>{if(e.preventDefault(),R)try{ex().then()}catch(t){}},ej=e=>{D(e)},e_=()=>{D(""),Q().then()},ey=e=>{0===e.currentTarget.scrollTop&&en&&(er().then(),e.currentTarget.scrollTop=300,W(!1))},ew=()=>{var e,t,r;return(null==E?void 0:E.receiver_type)==="vendor"?null==n?void 0:null===(t=n.base_urls)||void 0===t?void 0:t.store_image_url:(null==E?void 0:E.receiver_type)==="delivery_man"?null==n?void 0:null===(r=n.base_urls)||void 0===r?void 0:r.delivery_man_image_url:void(null==n||null===(e=n.base_urls)||void 0===e||e.business_logo_url)};return(0,r.jsx)(eH.Z,{refetch:ei,pathName:"chat",children:(0,r.jsx)(u.uu,{children:(0,r.jsxs)(u.Xw,{spacing:1,direction:"row",children:[(0,r.jsx)(m.Z,{children:(0,r.jsx)(A,{onClose:q,handleToggleSidebar:$,open:h,handleChannelOnClick:es,isFetched:J,channelList:f,searchValue:R,setSearchValue:D,handleSearch:ej,handleReset:e_,searchSubmitHandler:ef,channelLoading:Y,selectedId:null==E?void 0:E.id,chatFrom:G,setIsSidebarOpen:p})}),(0,r.jsxs)(u.Xw,{children:[E&&(0,r.jsx)(eZ,{receiver:E,mdUp:V,handleToggleSidebar:$,ChatImageUrl:ew,userImage:H,theme:i}),x&&Z.length>0&&!el&&(0,r.jsx)(eh,{conversationData:null==Z?void 0:null===(t=Z[0])||void 0===t?void 0:t.pages,handleChatMessageSend:eu,channelList:f,handleScroll:ey,scrollBottom:U}),el&&(0,r.jsx)(eb,{}),!x&&(0,r.jsx)(eg,{})]})]})})})},eV=e=>{let{configData:t,landingPageData:n}=e,{t:l}=(0,d.$G)(),u=(0,c.useRouter)();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.ZP,{}),(0,r.jsx)(o.default,{title:"Chat - ".concat(null==t?void 0:t.business_name)}),(0,r.jsx)(a.Z,{configData:t,landingPageData:n,children:(0,r.jsx)(s.Z,{from:u.pathname.replace("/",""),children:(0,r.jsx)(eT,{configData:t})})})]})};var eP=!0,eO=eV},59497:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(61176),l=n(60274),i=n(88767),o=n(67759);let a=async()=>{let{data:e}=await r.Z.get(l.ul);return e};function s(e){return(0,i.useQuery)("user-info",()=>a(),{enabled:!0,staleTime:1e4,cacheTime:5e3,onSuccess:e,onError:o.f})}},73369:function(e,t,n){"use strict";var r=n(85893);n(67294);var l=n(50594),i=n(58861),o=n(45269),a=n(62097);let s=e=>{(0,a.Z)();let{modalImage:t,handleModalClose:n}=e;return(0,r.jsxs)(o.Xw,{sx:{position:"relative",width:{xs:"270px",sm:"500px"}},alignItems:"flex-end",children:[(0,r.jsx)("button",{onClick:()=>n(!1),style:{cursor:"pointer",border:"none",borderRadius:"50%",width:" 2rem",height:"2rem"},children:(0,r.jsx)(l.Z,{sx:{fontSize:"16px"}})}),(0,r.jsx)(i.Z,{src:t,width:"100%",height:"100%"})]})};s.propTypes={},t.Z=s},65213:function(e,t,n){"use strict";n.d(t,{UK:function(){return c},ef:function(){return d},qo:function(){return u},yj:function(){return a},zU:function(){return s}});var r=n(81719),l=n(30120),i=n(44731),o=n(49837);let a=(0,r.ZP)(l.Z)(e=>{let{theme:t,authortype:n,usertype:r,language_direction:l}=e;return{display:"flex",flexDirection:n===r?"row-reverse":"row",maxWidth:500,marginLeft:n===r?"rtl"===l?0:"auto":0,marginBottom:"1rem",marginRight:n===r&&"rtl"===l?"auto":0}}),s=(0,r.ZP)(i.Z)(e=>{let{theme:t,authortype:n,usertype:r}=e;return{height:32,marginLeft:n===r?2:0,marginRight:n===r?0:2,width:32}}),d=(0,r.ZP)(l.Z)(e=>{let{theme:t}=e;return{flexGrow:1,maxWidth:500}}),c=(0,r.ZP)(o.Z)(e=>{let{theme:t,authortype:n,usertype:r}=e;return{backgroundColor:n===r?t.palette.neutral[200]:t.palette.neutral[700],color:n===r?t.palette.primary.contrastText:"text.primary",paddingLeft:"1rem",paddingRight:"1rem",paddingTop:".1rem",paddingBottom:".5rem"}}),u=(0,r.ZP)(l.Z)(e=>{let{theme:t,authortype:n,usertype:r}=e;return{display:"flex",justifyContent:n===r?"flex-end":"flex-start",marginTop:1,paddingTop:2}})},57542:function(e,t,n){"use strict";n.d(t,{Z:function(){return H}});var r=n(85893),l=n(67294),i=n(45697),o=n.n(i),a=n(37685),s=n(25118),d=n(20580),c=n(45269),u=n(47962),v=n(76638),h=n(26145),p=n(83765),m=n(36111),x=n(40077);n(73782);var g=n(81401),f=n(35969),j=n(60082),Z=n(53523),_=n(51126),y=n(13080),b=n(11163),w=n(9473),S=n(58345);let C={maxWidth:2e3,width:"100%",height:"100%",padding:"0px 1rem"},k=()=>{var e,t,n;let{wishLists:i}=(0,w.v9)(e=>e.wishList),{cartList:o}=(0,w.v9)(e=>e.cart),{selectedModule:a}=(0,w.v9)(e=>e.utilsData),s=(null==i?void 0:null===(e=i.item)||void 0===e?void 0:e.length)+(null==i?void 0:null===(t=i.store)||void 0===t?void 0:t.length),[d,k]=(0,l.useState)(!1),z=(0,b.useRouter)(),I=z.pathname.replace("/",""),L=()=>{k(!0)};return(0,r.jsx)(c.Xw,{children:(0,r.jsxs)(g.Z,{sx:{position:"fixed",bottom:0,left:0,right:0,padding:"5px",width:"100%",zIndex:111},elevation:3,children:[(0,r.jsx)(x.Z,{style:C,children:(0,r.jsxs)(f.Z,{value:I,onChange(e,t){"cart"!==t&&z.push("/".concat(t),void 0,{shallow:!0})},showLabels:!0,children:[(0,r.jsx)(Z.rj,{label:(0,_.t)("Home"),value:"home",icon:(0,r.jsx)(v.Z,{})}),(0,r.jsx)(Z.rj,{label:(0,_.t)("My Orders"),value:"my-orders",icon:(0,r.jsx)(j.Z,{color:"error",children:(0,r.jsx)(u.Z,{})})}),(null==a?void 0:a.module_type)!=="parcel"&&(0,r.jsx)(Z.rj,{onClick:()=>L(),label:(0,_.t)("Cart"),value:"cart",icon:(0,r.jsx)(j.Z,{badgeContent:null===(n=(0,S.l)(o))||void 0===n?void 0:n.length,color:"error",children:(0,r.jsx)(p.Z,{})})}),(0,r.jsx)(Z.rj,{label:(0,_.t)("Chat"),value:"chatting",icon:(0,r.jsx)(j.Z,{badgeContent:0,color:"error",children:(0,r.jsx)(h.Z,{})})}),!!d&&(0,r.jsx)(y.Z,{sideDrawerOpen:d,setSideDrawerOpen:k}),(0,r.jsx)(Z.rj,{label:(0,_.t)("WishList"),value:"wishlist",icon:(0,r.jsx)(j.Z,{badgeContent:s,color:"error",children:(0,r.jsx)(m.Z,{})})})]})}),!!d&&(0,r.jsx)(y.Z,{sideDrawerOpen:d,setSideDrawerOpen:k,cartList:o})]})})};var z=l.memo(k),I=n(62097),L=n(61225),R=n(28332),D=n(38579),E=n(67493);let M=e=>{let{children:t,configData:n,landingPageData:i}=e,[o,u]=(0,l.useState)(!1),{data:v,refetch:h}=(0,D.Z)();(0,I.Z)();let p=(0,L.Z)("(max-width:1180px)"),m=(0,b.useRouter)(),x=(0,w.I0)();if((0,l.useEffect)(()=>{"/home"===m.pathname&&h()},[]),v){var g;let f=null===(g=JSON.parse(localStorage.getItem("module")))||void 0===g?void 0:g.module_type;if(0===v.length)localStorage.removeItem("module"),m.push("/",void 0,{shallow:!0});else if(!(null==v?void 0:v.find(e=>e.module_type===f))){let j=v[0];localStorage.setItem("module",JSON.stringify(j)),x((0,E.$w)(j))}}return(0,r.jsxs)(d.U,{justifyContent:"space-between",children:[(0,r.jsx)("header",{children:(0,r.jsx)(a.Z,{configData:n})}),(0,r.jsx)(c.Xw,{mt:p?"5rem":"7rem",children:(0,r.jsx)(c.Xw,{sx:{minHeight:"70vh"},children:(0,r.jsx)(R.Z,{children:t})})}),(0,r.jsx)("footer",{children:(0,r.jsx)(s.Z,{configData:n,landingPageData:i})}),p&&(0,r.jsx)(z,{})]},o)};M.propTypes={children:o().node};var H=l.memo(M)},46941:function(e,t,n){"use strict";var r=n(85893),l=n(67294),i=n(11163);let o=e=>{let{children:t,from:n}=e,o=(0,i.useRouter)(),[a,s]=(0,l.useState)(!1);return((0,l.useEffect)(()=>{if(!o.isReady)return;let e=localStorage.getItem("token");e?s(!0):o.push({pathname:"/auth/sign-in",query:{from:n}},void 0,{shallow:!0})},[o.isReady]),a)?(0,r.jsx)(r.Fragment,{children:t}):null};t.Z=o}},function(e){e.O(0,[1255,2506,6454,5269,580,9774,2888,179],function(){return e(e.s=31449)}),_N_E=e.O()}]);